# ============================================
# Traefik Dynamic Configuration - Middlewares
# ============================================

http:
  middlewares:
    # Security Headers
    security-headers:
      headers:
        frameDeny: true
        browserXssFilter: true
        contentTypeNosniff: true
        sslRedirect: true
        stsIncludeSubdomains: true
        stsPreload: true
        stsSeconds: 31536000
        customResponseHeaders:
          X-Robots-Tag: "noindex,nofollow"
          Server: ""  # Hide server header

    # CORS for API
    api-cors:
      headers:
        accessControlAllowMethods:
          - GET
          - POST
          - PUT
          - DELETE
          - PATCH
          - OPTIONS
        accessControlAllowHeaders:
          - "*"
        accessControlAllowOriginList:
          - "https://crm.fvienot.link"
        accessControlMaxAge: 100
        addVaryHeader: true

    # Rate Limiting - Strict
    rate-limit-strict:
      rateLimit:
        average: 10
        burst: 20
        period: 1m

    # Rate Limiting - Normal
    rate-limit-normal:
      rateLimit:
        average: 100
        burst: 50
        period: 1m

    # Compress responses
    compress-response:
      compress: {}

    # IP Whitelist (optional - for admin routes)
    # admin-whitelist:
    #   ipWhiteList:
    #     sourceRange:
    #       - "127.0.0.1/32"
    #       - "192.168.1.0/24"
